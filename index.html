<!doctype html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CWL Website</title>
  <link href='./style.css' rel='stylesheet'>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
  <div id="barTop"><p id="logo">LOGO</p></div>
  <div id="mainContent">
    <div><h1>Les pronos des GM</h1></div>
    <div>
      <button id="showTeamsButton">Afficher les équipes</button>
      <div id="selectionContainer"></div>
      <button id="generateTablesButton">Générer les tableaux</button>
      <button id="captureTablesButton">Capturer les tableaux</button> <!-- Nouveau bouton pour capturer les tableaux -->
      <div id="teamsContainer">
        <table id="eastTeamsTable">
          <thead>
            <tr>
              <th>Place</th>
              <th>Équipe</th>
              <th>Photo</th>
            </tr>
          </thead>
          <tbody>
            <!-- Les équipes de la conférence Est seront ajoutées ici -->
          </tbody>
        </table>
        <table id="westTeamsTable">
          <thead>
            <tr>
              <th>Place</th>
              <th>Équipe</th>
              <th>Photo</th>
            </tr>
          </thead>
          <tbody>
            <!-- Les équipes de la conférence Ouest seront ajoutées ici -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <script src="teamsCWL.js"></script>
  <script>
    function createOptions(teams) {
      let options = '<option value="">Sélectionner une équipe</option>';
      teams.forEach(team => {
        options += `<option value="${team.nom}">${team.nom}</option>`;
      });
      return options;
    }

    document.getElementById('showTeamsButton').addEventListener('click', function() {
      const selectionContainer = document.getElementById('selectionContainer');
      selectionContainer.innerHTML = '';

      const eastHeader = document.createElement('h2');
      eastHeader.textContent = 'Conférence Est';
      selectionContainer.appendChild(eastHeader);

      for (let i = 0; i < 15; i++) {
        const select = document.createElement('select');
        select.id = `eastTeam${i}`;
        select.classList.add('eastSelect');
        select.innerHTML = createOptions(teamsEastCWL);
        selectionContainer.appendChild(select);
      }

      const westHeader = document.createElement('h2');
      westHeader.textContent = 'Conférence Ouest';
      selectionContainer.appendChild(westHeader);

      for (let i = 0; i < 15; i++) {
        const select = document.createElement('select');
        select.id = `westTeam${i}`;
        select.classList.add('westSelect');
        select.innerHTML = createOptions(teamsWestCWL);
        selectionContainer.appendChild(select);
      }

      const eastSelects = document.querySelectorAll('.eastSelect');
      const westSelects = document.querySelectorAll('.westSelect');

      eastSelects.forEach(select => {
        select.addEventListener('change', updateEastOptions);
      });

      westSelects.forEach(select => {
        select.addEventListener('change', updateWestOptions);
      });
    });

    function updateEastOptions() {
      const selectedValues = [...document.querySelectorAll('.eastSelect')].map(select => select.value);
      document.querySelectorAll('.eastSelect option').forEach(option => {
        if (option.value === '') return;
        option.disabled = selectedValues.includes(option.value);
      });
    }

    function updateWestOptions() {
      const selectedValues = [...document.querySelectorAll('.westSelect')].map(select => select.value);
      document.querySelectorAll('.westSelect option').forEach(option => {
        if (option.value === '') return;
        option.disabled = selectedValues.includes(option.value);
      });
    }

    function createTeamRows(teams, tableBody) {
      teams.forEach((team, index) => {
        const row = document.createElement('tr');
        const placeCell = document.createElement('td');
        const nameCell = document.createElement('td');
        const photoCell = document.createElement('td');
        const photo = document.createElement('img');

        placeCell.textContent = index + 1;
        nameCell.textContent = team ? team.nom : 'N/A';
        photo.src = team ? team.image : '';
        photo.alt = team ? team.nom : 'No photo';
        photo.width = 50;

        photoCell.appendChild(photo);
        row.appendChild(placeCell);
        row.appendChild(nameCell);
        row.appendChild(photoCell);
        tableBody.appendChild(row);
      });
    }

    document.getElementById('generateTablesButton').addEventListener('click', function() {
      const eastTeamsTableBody = document.querySelector('#eastTeamsTable tbody');
      const westTeamsTableBody = document.querySelector('#westTeamsTable tbody');

      eastTeamsTableBody.innerHTML = '';
      westTeamsTableBody.innerHTML = '';

      const selectedEastTeams = [];
      const selectedWestTeams = [];

      for (let i = 0; i < 15; i++) {
        const eastTeamName = document.getElementById(`eastTeam${i}`).value;
        const westTeamName = document.getElementById(`westTeam${i}`).value;

        const eastTeam = teamsEastCWL.find(team => team.nom === eastTeamName);
        const westTeam = teamsWestCWL.find(team => team.nom === westTeamName);

        selectedEastTeams.push(eastTeam);
        selectedWestTeams.push(westTeam);
      }

      createTeamRows(selectedEastTeams, eastTeamsTableBody);
      createTeamRows(selectedWestTeams, westTeamsTableBody);
    });

    document.getElementById('captureTablesButton').addEventListener('click', function() {
      const tablesContainer = document.getElementById('teamsContainer');
      html2canvas(tablesContainer).then(canvas => {
        const link = document.createElement('a');
        link.href = canvas.toDataURL('image/png');
        link.download = 'tables.png';
        link.click();
      });
    });
  </script>
</body>
</html>
